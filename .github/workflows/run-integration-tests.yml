name: "Run integration Tests"
on:
  # pull_request:
  #   types:
  #     - opened
  push:
    branches:
      - assignment_5
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: Get Code
        uses: actions/checkout@v3
      - name: Setup Node
        uses: actions/setup-node@v4
        with:
          node-version: "19"
      - name: Creating a .env
        run: |
          echo "user=${{secrets.MYSQL_USERNAME}}" > .env
          echo "password=${{secrets.MYSQL_PASSWORD}}" >> .env
          echo "host=localhost" >> .env
      - name: Temp
        run: | 
          echo "SECRET_VALUE=${{ secrets.MYSQL_USERNAME }}"
          echo "SECRET_VALUE=${{ secrets.MYSQL_PASSWORD }}"
      # - uses: actions/checkout@v4
      # - uses: shogo82148/actions-setup-mysql@v1
      #   with:
      #     mysql-version: "8.0"
      #     root-password: ${{secrets.MYSQL_PASSWORD}}
      # - name: Create DATABASES
      #   run: |
      #     mysql -uroot -p${{secrets.MYSQL_PASSWORD}} -e 'CREATE DATABASE ${{vars.DATABASE_NAME}};'
      #     mysql -uroot -p${{secrets.MYSQL_PASSWORD}} -e 'SHOW DATABASES;'
      #   env:
      #     DATABASE_NAME: ${{vars.DATABASE_NAME}}
      - name: Starting node server
        run: |
          npm install
          npm start 
      # - name: Calling heatlh endpoint
      #   run: |
      #     curl -vvvv http://localhost:8080/healthz
      # - name: Calling Integrations tests
      #   run: npm run test
